# Day 09: æ¨¡å—ç³»ç»Ÿ (Modules)

## ğŸ“ å­¦ä¹ ç›®æ ‡
- ç†è§£ Rust ä»£ç ç»„ç»‡ç»“æ„ï¼šPackageã€Crate å’Œ Module
- æŒæ¡æ¨¡å—å®šä¹‰ä¸æ–‡ä»¶æ‹†åˆ†
- æ·±å…¥ç†è§£å¯è§æ€§è§„åˆ™ (`pub`, `priv`)
- ç†Ÿç»ƒä½¿ç”¨è·¯å¾„ (`crate`, `super`, `self`) å¼•ç”¨é¡¹
- æŒæ¡ `use` å…³é”®å­—å¼•å…¥ä½œç”¨åŸŸä¸ `pub use` é‡å¯¼å‡º

## ğŸ¯ ä¸ºä»€ä¹ˆè¦å­¦è¿™ä¸ª
éšç€ä»£ç é‡çš„å¢åŠ ï¼Œå°†æ‰€æœ‰ä»£ç å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ã€‚Rust çš„æ¨¡å—ç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„å·¥å…·æ¥å¸®åŠ©ä½ ï¼š
- **ç»„ç»‡ä»£ç **: å°†ç›¸å…³åŠŸèƒ½åˆ†ç»„ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚
- **æ§åˆ¶å¯è§æ€§**: éšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„å…¬å…± APIï¼ˆå°è£…ï¼‰ã€‚
- **é‡ç”¨ä»£ç **: æ–¹ä¾¿åœ¨ä¸åŒé¡¹ç›®é—´å…±äº«ä»£ç ã€‚

## ğŸ“– æ ¸å¿ƒæ¦‚å¿µ

### 1. ä»£ç ç»„ç»‡å±‚æ¬¡
Rust çš„æ¨¡å—ç³»ç»Ÿç”±ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š
- **åŒ… (Package)**: ä¸€ä¸ª Cargo é¡¹ç›®ï¼ŒåŒ…å« `Cargo.toml` é…ç½®æ–‡ä»¶ã€‚ä¸€ä¸ªåŒ…å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–ä¸€ä¸ªåº“ Crateï¼Œä»¥åŠä»»æ„å¤šä¸ªäºŒè¿›åˆ¶ Crateã€‚
- **Crate**: ç¼–è¯‘å•å…ƒã€‚å¯ä»¥æ˜¯åº“ (Library Crate) æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ (Binary Crate)ã€‚
- **æ¨¡å— (Module)**: åœ¨ Crate å†…éƒ¨ç»„ç»‡ä»£ç çš„å•å…ƒï¼Œå¯ä»¥åµŒå¥—ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚

### 2. å®šä¹‰æ¨¡å—
ä½¿ç”¨ `mod` å…³é”®å­—å®šä¹‰æ¨¡å—ã€‚æ¨¡å—å†…å¯ä»¥åŒ…å«å‡½æ•°ã€ç»“æ„ä½“ã€æšä¸¾ã€å¸¸é‡ã€Traitï¼Œç”šè‡³å…¶ä»–æ¨¡å—ã€‚

```rust
// lib.rs æˆ– main.rs

mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}
    }
}
```

### 3. è·¯å¾„ (Paths)
è¦åœ¨æ¨¡å—æ ‘ä¸­æ‰¾åˆ°æŸä¸ªé¡¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è·¯å¾„ï¼š
- **ç»å¯¹è·¯å¾„**: ä» Crate æ ¹å¼€å§‹ï¼Œä»¥ `crate` å¼€å¤´ã€‚
- **ç›¸å¯¹è·¯å¾„**: ä»å½“å‰æ¨¡å—å¼€å§‹ï¼Œä»¥ `self`ã€`super` æˆ–å½“å‰æ¨¡å—åå¼€å¤´ã€‚

### 4. å¯è§æ€§ (Visibility)
Rust ä¸­é»˜è®¤æ‰€æœ‰é¡¹ï¼ˆå‡½æ•°ã€æ–¹æ³•ã€ç»“æ„ä½“ã€æšä¸¾ã€æ¨¡å—å’Œå¸¸é‡ï¼‰éƒ½æ˜¯ **ç§æœ‰çš„ (private)**ã€‚
- çˆ¶æ¨¡å—æ— æ³•ç›´æ¥è®¿é—®å­æ¨¡å—çš„ç§æœ‰é¡¹ã€‚
- å­æ¨¡å—å¯ä»¥ä½¿ç”¨ç¥–å…ˆæ¨¡å—ä¸­çš„æ‰€æœ‰é¡¹ï¼ˆåŒ…æ‹¬ç§æœ‰çš„ï¼‰ã€‚
- ä½¿ç”¨ `pub` å…³é”®å­—å°†é¡¹æ ‡è®°ä¸ºå…¬æœ‰ã€‚

### 5. use å…³é”®å­—
`use` å…³é”®å­—å¯ä»¥å°†è·¯å¾„å¼•å…¥å½“å‰ä½œç”¨åŸŸï¼Œåƒåˆ›å»ºè½¯é“¾æ¥ä¸€æ ·ï¼Œé¿å…æ¯æ¬¡éƒ½å†™é•¿é•¿çš„è·¯å¾„ã€‚

```rust
use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

## ğŸ’» ä»£ç ç¤ºä¾‹

### ç¤ºä¾‹ 1: æ¨¡å—å®šä¹‰ä¸å¯è§æ€§
```rust
mod back_of_house {
    pub struct Breakfast {
        pub toast: String,      // å…¬æœ‰å­—æ®µ
        seasonal_fruit: String, // ç§æœ‰å­—æ®µ
    }

    impl Breakfast {
        pub fn summer(toast: String) -> Breakfast {
            Breakfast {
                toast,
                seasonal_fruit: String::from("peaches"),
            }
        }
    }
}

pub fn eat_at_restaurant() {
    // è®¢è´­ä¸€ä»½æ—©é¤ï¼Œå¯ä»¥éšå¿ƒæ‰€æ¬²åœ°æ”¹å˜åå¸çš„ç±»å‹
    let mut meal = back_of_house::Breakfast::summer(String::from("Rye"));
    meal.toast = String::from("Wheat");
    println!("I'd like {} toast please", meal.toast);

    // ä¸‹é¢è¿™è¡Œä»£ç ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸º seasonal_fruit å­—æ®µæ˜¯ç§æœ‰çš„
    // meal.seasonal_fruit = String::from("blueberries");
}
```

### ç¤ºä¾‹ 2: ä½¿ç”¨ super è®¿é—®çˆ¶æ¨¡å—
```rust
fn serve_order() {}

mod back_of_house {
    fn fix_incorrect_order() {
        cook_order();
        // ä½¿ç”¨ super è®¿é—®çˆ¶æ¨¡å—ä¸­çš„å‡½æ•°
        super::serve_order();
    }

    fn cook_order() {}
}
```

## ğŸ› ï¸ æ¨¡å—æ‹†åˆ† (æ–‡ä»¶ç»“æ„)
å½“æ¨¡å—å˜å¤§æ—¶ï¼Œåº”è¯¥å°†å…¶æ‹†åˆ†åˆ°ç‹¬ç«‹æ–‡ä»¶ä¸­ã€‚Rust æ”¯æŒä¸¤ç§é£æ ¼ï¼š

**é£æ ¼ 1 (ç°ä»£é£æ ¼ï¼Œæ¨è):**
```text
src/
â”œâ”€â”€ lib.rs
â”œâ”€â”€ front_of_house.rs  <-- å¯¹åº” mod front_of_house
â””â”€â”€ front_of_house/
    â””â”€â”€ hosting.rs     <-- å¯¹åº” mod front_of_house é‡Œçš„ mod hosting
```

**é£æ ¼ 2 (ä¼ ç»Ÿé£æ ¼):**
```text
src/
â”œâ”€â”€ lib.rs
â”œâ”€â”€ front_of_house/
    â”œâ”€â”€ mod.rs         <-- å¯¹åº” mod front_of_house
    â””â”€â”€ hosting.rs
```

åœ¨ `lib.rs` ä¸­å£°æ˜æ¨¡å—ï¼š
```rust
mod front_of_house; // å‘Šè¯‰ç¼–è¯‘å™¨å»æŸ¥æ‰¾ front_of_house.rs æˆ– front_of_house/mod.rs

pub use crate::front_of_house::hosting; // é‡å¯¼å‡ºï¼Œæ–¹ä¾¿å¤–éƒ¨ä½¿ç”¨
```

## ğŸ‹ï¸ ç»ƒä¹ é¢˜

æˆ‘ä»¬å‡†å¤‡äº†ç»ƒä¹ é¢˜æ¥å¸®åŠ©ä½ æŒæ¡æ¨¡å—ç³»ç»Ÿçš„ä½¿ç”¨ã€‚

- **ç»ƒä¹  1**: ä¿®å¤å¯è§æ€§é”™è¯¯
- **ç»ƒä¹  2**: ä½¿ç”¨ `use` ç®€åŒ–ä»£ç 
- **ç»ƒä¹  3**: å°†å•æ–‡ä»¶æ¨¡å—é‡æ„ä¸ºå¤šæ–‡ä»¶ç»“æ„

ğŸ‘‰ **[ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ç»ƒä¹ é¢˜](./exercises/README.md)**

## ğŸ¤” å¸¸è§é—®é¢˜ (FAQ)

### Q1: `mod.rs` å’Œ `æ–‡ä»¶å.rs` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
A: å®ƒä»¬åœ¨åŠŸèƒ½ä¸Šæ˜¯ä¸€æ ·çš„ã€‚`mod.rs` æ˜¯ Rust 2015 çš„é£æ ¼ï¼Œç±»ä¼¼äº `index.html`ã€‚`æ–‡ä»¶å.rs` æ˜¯ Rust 2018 å¼•å…¥çš„é£æ ¼ï¼Œæ›´ç®€æ´ï¼Œé¿å…äº†ç¼–è¾‘å™¨ä¸­æ‰“å¼€å¾ˆå¤šä¸ª `mod.rs` å¯¼è‡´æ··æ·†ã€‚ç°åœ¨æ¨èä½¿ç”¨åè€…ã€‚

### Q2: ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ `pub use`ï¼Ÿ
A: å½“ä½ å¸Œæœ›é‡æ–°ç»„ç»‡ crate çš„å…¬å…± API ç»“æ„ï¼Œä½¿å…¶ä¸å†…éƒ¨å®ç°ç»“æ„ä¸åŒæ—¶ã€‚ä¾‹å¦‚ï¼Œä½ å†…éƒ¨æœ‰å¾ˆå¤šåµŒå¥—æ¨¡å—ï¼Œä½†å¸Œæœ›ç”¨æˆ·èƒ½ç›´æ¥ä»é¡¶çº§æ¨¡å—å¯¼å…¥å¸¸ç”¨åŠŸèƒ½ã€‚

### Q3: äºŒè¿›åˆ¶ crate (`main.rs`) å¯ä»¥åŒ…å«æ¨¡å—å—ï¼Ÿ
A: å¯ä»¥ã€‚ä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸å»ºè®®å°†æ ¸å¿ƒé€»è¾‘æ”¾å…¥åº“ crate (`lib.rs`)ï¼Œè€Œ `main.rs` åªè´Ÿè´£è§£æå‚æ•°å’Œè°ƒç”¨åº“å‡½æ•°ã€‚è¿™æ ·æ›´å®¹æ˜“æµ‹è¯•å’Œé‡ç”¨ä»£ç ã€‚

## ğŸ’¡ æœ€ä½³å®è·µ
- **åº“å¼€å‘**: å°† `main.rs` ä¿æŒç²¾ç®€ï¼Œé€»è¾‘æ”¾å…¥ `lib.rs`ã€‚
- **Prelude æ¨¡å¼**: å¦‚æœä½ çš„åº“æœ‰å¾ˆå¤šå¸¸ç”¨çš„ trait æˆ–ç»“æ„ä½“ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª `prelude` æ¨¡å—å¹¶é€šè¿‡ `pub use` å¯¼å‡ºå®ƒä»¬ï¼Œæ–¹ä¾¿ç”¨æˆ·ä¸€æ¬¡æ€§å¯¼å…¥ã€‚
- **ä¿æŒç§æœ‰**: é»˜è®¤ä¿æŒæ¨¡å—å’Œå­—æ®µç§æœ‰ï¼Œåªæœ‰ç¡®æœ‰å¿…è¦æš´éœ²ç»™å¤–éƒ¨æ—¶æ‰æ·»åŠ  `pub`ã€‚

## ğŸ”— æ‰©å±•é˜…è¯»
- [Rust ç¨‹åºè®¾è®¡è¯­è¨€ - æ¨¡å—ç³»ç»Ÿ](https://doc.rust-lang.org/book/ch07-00-managing-growing-projects-with-packages-crates-and-modules.html)

## â­ï¸ ä¸‹ä¸€æ­¥
æŒæ¡äº†ä»£ç ç»„ç»‡æ–¹å¼åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Rust æ ‡å‡†åº“ä¸­æä¾›çš„å¸¸ç”¨æ•°æ®ç»“æ„ã€‚

ä¸‹ä¸€èŠ‚: [Day 10: å¸¸ç”¨é›†åˆ](../10.CommonCollections/README.md)
